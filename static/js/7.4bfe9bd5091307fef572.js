webpackJsonp([7],{"1MAN":function(e,s){},Mc9I:function(e,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t={data:function(){return{userList:[],userNo:null,friends:[],friendNo:[],insurance:!1,invoice:!1,cardObj:{},orderObj:{},addModel:!1,loading:!1}},computed:{adtPrice:function(){var e=0,s=0;for(var i in this.friendNo)this.friends[i].age>=12&&(e+=this.cardObj.price.fdPrice,s++);return{price:e,num:s}},chdPrice:function(){var e=0,s=0;for(var i in this.friendNo)this.friends[i].age<12&&this.friends[i].age>=2&&(e+=.5*this.cardObj.price.fdPrice,s++);return{price:e,num:s}},babyPrice:function(){var e=0,s=0;for(var i in this.friendNo)this.friends[i].age<2&&(e+=.1*this.cardObj.price.fdPrice,s++);return{price:e,num:s}},totalPrice:function(){var e=this.adtPrice.price+this.chdPrice.price+this.babyPrice.price+this.cardObj.price.taxFee*this.adtPrice.num+this.cardObj.price.taxFee*this.chdPrice.num*.5+this.cardObj.price.fuelFee*this.friendNo.length;return this.insurance&&(e+=5*this.friendNo.length),e}},methods:{selectUser:function(){this.friendNo=[],this.friends=[];var e=this;this.$http.get("/friend/searchbybuyerphone/",{params:{phone:e.userList[e.userNo].Phone}}).then(function(s){var i=[{Name:e.userList[e.userNo].Name,Phone:e.userList[e.userNo].Phone,thisID:e.userList[e.userNo].thisID}];for(var t in e.friends=i.concat(s.data),e.friends)e.friends[t].age=e.getAge(e.friends[t].thisID)}).catch(function(e){console.log(e)})},getAge:function(e){var s=new Date(this.cardObj.departDate),i=s.getMonth()+1,t=s.getDate(),a=s.getFullYear()-e.substring(6,10)-1;return(e.substring(10,12)<i||e.substring(10,12)===i&&e.substring(12,14)<=t)&&a++,a},addOk:function(){this.$Message.info("ok")},addCancel:function(){this.$Message.info("cancel")},confirmSend:function(){var e=this;for(var s in this.loading=!0,this.orderObj.cName=this.userList[this.userNo].Name,this.orderObj.cPhone=this.userList[this.userNo].Phone,this.orderObj.prices=[],this.orderObj.travelers=[],this.friendNo){var i=this.cardObj.price,t={ageType:"",name:"",cardType:"",cardNo:"",phone:""};this.friends[s].age>=12?(i.ageType="ADT",t.ageType="ADT"):this.friends[s].age>=2?(i.ageType="CHD",t.ageType="CHD"):(i.ageType="INF",t.ageType="INF"),t.name=this.friends[s].Name,t.cardType="NI",t.cardNo=this.friends[s].thisID,t.phone=this.friends[s].Phone,this.orderObj.prices.push(i),this.orderObj.travelers.push(t)}this.$http.post("/jp/buyPlaneTicket/",e.orderObj).then(function(s){console.log(s.data),"200"===s.data.code?e.$router.push("/flightContact"):(e.loading=!1,e.$message("订单提交失败，请重新发送订单"))}).catch(function(e){console.log(e)}),console.log(this.orderObj)}},created:function(){var e=this.$route.query,s=this;console.log(e),this.cardObj=e.cardObj,this.orderObj=e.orderObj,this.$http.get("/user/showall/").then(function(e){s.userList=e.data}).catch(function(e){console.log(e)})}},a={render:function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content"},[i("el-card",{staticClass:"order-left"},[i("div",{staticClass:"search-block"},[i("span",[e._v("用户选择")]),e._v("    "),i("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"filterable",placeholder:"手机号码选择乘机用户"},on:{change:e.selectUser},model:{value:e.userNo,callback:function(s){e.userNo=s},expression:"userNo"}},e._l(e.userList,function(e,s){return i("el-option",{key:e.Phone,attrs:{value:s,label:e.Phone+" - "+e.Name}})})),e._v(" "),i("el-button",{attrs:{type:"warning",round:"round",icon:"el-icon-plus"}},[e._v("添加用户")])],1),i("div",{staticClass:"friend-block"},[i("h3",{staticClass:"friend-block__head"},[e._v("机主关联乘客"),i("span",{staticClass:"friend-block__head_sub"},[e._v("(跟机主关联的所有乘客)")])]),i("el-card",{staticClass:"friend-block__card"},[null!==e.userNo?i("p",{staticClass:"friend-block__card_host"},[e._v(e._s(e.userList[e.userNo].Name)+"(机主)")]):e._e(),i("el-checkbox-group",{model:{value:e.friendNo,callback:function(s){e.friendNo=s},expression:"friendNo"}},e._l(e.friends,function(s,t){return i("el-checkbox",{key:s.Name,attrs:{label:t}},[e._v(e._s(s.Name))])}))],1),i("el-button",{attrs:{type:"info",icon:"el-icon-plus"},on:{click:function(s){e.addModel=!0}}},[e._v("新增乘客")]),i("el-dialog",{attrs:{title:"新增机主",visible:e.addModel,width:"30%"},on:{"update:visible":function(s){e.addModel=s}}})],1),i("div",{staticClass:"passenger-block"},[i("h3",{staticClass:"passenger-block__head"},[e._v("乘机人信息")]),e._l(e.friendNo,function(s){return i("div",{staticClass:"passenger-block__card"},[i("div",{staticClass:"passenger-block__card_left"},[i("p",[i("i",{staticClass:"el-icon-edit"})])]),i("div",{staticClass:"passenger-block__card_middle"},[i("p",{staticClass:"line"},[i("span",{staticClass:"label"},[e._v("姓名:")]),i("span",{staticClass:"detail"},[e._v(e._s(e.friends[s].Name))])]),i("p",{staticClass:"line"},[i("span",{staticClass:"label"},[e._v("身份证:")]),i("span",{staticClass:"detail"},[e._v(e._s(e.friends[s].thisID))])]),i("p",{staticClass:"line"},[i("span",{staticClass:"label"},[e._v("电话:")]),i("span",{staticClass:"detail"},[e._v(e._s(e.friends[s].Phone))])])]),i("div",{staticClass:"passenger-block__card_right"},[i("p",{staticClass:"line"},[e.friends[s].age>=12?i("span",{staticClass:"detail"},[e._v("成人：￥"+e._s(e.cardObj.price.fdPrice))]):e.friends[s].age>=2?i("span",{staticClass:"detail"},[e._v("儿童：￥"+e._s(.5*e.cardObj.price.fdPrice))]):i("span",{staticClass:"detail"},[e._v("婴儿：￥"+e._s(.1*e.cardObj.price.fdPrice))])])])])})],2),i("div",{staticClass:"select-block"},[i("div",{staticClass:"select-block__choice"},[i("p",{staticClass:"select-block__choice_line"},[i("el-checkbox",{attrs:{size:"large"},model:{value:e.insurance,callback:function(s){e.insurance=s},expression:"insurance"}},[e._v("航空意外险")])],1)]),i("div",{staticClass:"select-block__choice"},[i("p",{staticClass:"select-block__choice_line"},[i("el-checkbox",{attrs:{size:"large"},model:{value:e.invoice,callback:function(s){e.invoice=s},expression:"invoice"}},[e._v("报销凭证(到付)")])],1)])])]),i("el-card",{staticClass:"order-right"},[i("el-card",{staticClass:"ticket-card"},[i("div",{staticClass:"ticket-card__head"},[i("h3",{staticClass:"ticket-card__head_title"},[i("span",[e._v(e._s(e.cardObj.departDate))]),i("span",[e._v(e._s(e.cardObj.departCityName)+" - "+e._s(e.cardObj.arriveCityName))])]),i("p",{staticClass:"ticket-card__head_sub"},[i("span",[e._v(e._s(e.cardObj.airline))]),i("span",[e._v(e._s(e.cardObj.no))]),"Y"===e.cardObj.level?i("span",[e._v("经济"+e._s(e.cardObj.cabin)+"舱")]):"F"===e.cardObj.level?i("span",[e._v("头等"+e._s(e.cardObj.cabin)+"舱")]):"C"===e.cardObj.level?i("span",[e._v("商务"+e._s(e.cardObj.cabin)+"舱")]):e._e()])]),i("div",{staticClass:"ticket-card__journey"},[i("div",{staticClass:"ticket-card__journey_left"},[i("h3",{staticClass:"clock"},[e._v(e._s(e.cardObj.departTime))]),i("p",{staticClass:"airport"},[e._v(e._s(e.cardObj.departPort))])]),i("div",{staticClass:"ticket-card__journey_middle"},[i("p",{staticClass:"last"},[e._v(e._s(e.cardObj.flightTime))]),i("p",{staticClass:"line"})]),i("div",{staticClass:"ticket-card__journey_right"},[i("h3",{staticClass:"clock"},[e._v(e._s(e.cardObj.arriveTime))]),i("p",{staticClass:"airport"},[e._v(e._s(e.cardObj.arrivePort))])])]),i("hr"),e.adtPrice.num||e.chdPrice.num||e.babyPrice.num?i("div",{staticClass:"ticket-card__content"},[e.adtPrice.num?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("成人票")]),i("span",{staticClass:"line_price"},[e._v("￥"+e._s(e.cardObj.price.fdPrice)+" X "+e._s(e.adtPrice.num))])])]):e._e(),e.chdPrice.num?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("儿童票")]),i("span",{staticClass:"line_price"},[e._v("￥"+e._s(this.cardObj.price.fdPrice)+" X "+e._s(e.chdPrice.num)+" X 0.5")])])]):e._e(),e.babyPrice.num?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("婴儿票")]),i("span",{staticClass:"line_price"},[e._v("￥"+e._s(this.cardObj.price.fdPrice)+" X "+e._s(e.babyPrice.num)+" X 0.1")])])]):e._e(),e.adtPrice.num||e.chdPrice.num||e.babyPrice.num?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("机建费")]),i("span",{staticClass:"line_price"},[e.adtPrice.num||e.chdPrice.num?i("span",[e.adtPrice.num?i("span",{staticClass:"line_price_adt"},[e._v("￥"+e._s(e.cardObj.price.taxFee)+" X "+e._s(e.adtPrice.num))]):e._e(),e.adtPrice.num&&e.chdPrice.num?i("span",{staticClass:"line_price_add"},[e._v("+")]):e._e(),e.chdPrice.num?i("span",{staticClass:"line_price_chd"},[e._v(e._s(e.cardObj.price.taxFee)+" X "+e._s(e.chdPrice.num)+" X 0.5")]):e._e()]):i("span",[e._v("￥0")])])])]):e._e(),e.adtPrice.num||e.chdPrice.num||e.babyPrice.num?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("燃油费")]),i("span",{staticClass:"line_price"},[e._v("￥"+e._s(e.cardObj.price.fuelFee*e.friendNo.length))])])]):e._e(),i("hr"),e.insurance?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("航空意外险")]),i("span",{staticClass:"line_price"},[e._v("￥5 X "+e._s(e.friendNo.length))])])]):e._e(),e.invoice?i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"line"},[i("span",{staticClass:"line_label"},[e._v("报销凭证")]),i("span",{staticClass:"line_price"},[e._v("到付")])])]):e._e(),i("div",{staticClass:"ticket-card__content_line"},[i("p",{staticClass:"total-price"},[e._v("￥"+e._s(e.totalPrice))])])]):e._e(),e.adtPrice.num||e.chdPrice.num||e.babyPrice.num?i("div",{staticClass:"ticket-card__confirm"},[i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.confirmSend}},[e._v("发给用户确认并自动预定")])],1):e._e()])],1)],1)},staticRenderFns:[]};var c=i("VU/8")(t,a,!1,function(e){i("1MAN")},"data-v-5448a800",null);s.default=c.exports}});
//# sourceMappingURL=7.4bfe9bd5091307fef572.js.map